# Series

## Introduction to Sequences and Series

### Sequences

#### Overview

Your intuition of a [sequence](https://en.wikipedia.org/wiki/Sequence) will likely be correct.
It can mean a sequence of letters, such as a word (e.g. A, U, S, T, R, A, L, I, A) or a DNA sequence 
(e.g. A, T, G, C, G, G, T, C, A, T, C).
It can also be a sequence of numbers such as a telephone number, date of birth, something nonsensical 
(e.g. $181291, 2, -4309, \sqrt{7}$) or the prime numbers: $2, 3, 5, 7, 11, \dots$.
Here, the dots indicate that the [sequence goes on infinitely](https://whatis.techtarget.com/definition/infinite-sequence).

Each part of the sequence is called a **term**.
Each sequence has a specific ordering of terms. 
For example, the series $1,2,3,4$ is different from the series $4,3,2,1$ much in the same way that the telephone number 
$18001234$ will reach a different person to the phone number $18004321$.

#### Sequences as numerical patterns

In this course sequences will be [numerical patterns](https://www.youtube.com/watch?v=vV7C7bXm4VI). 
Much of mathematics is concerned with patterns in both mathematical constructs and nature, the study of sequences 
provides a firm grounding for this endeavour.

A famous pattern that arises in many natural systems is the [Fibonacci sequence](https://en.wikipedia.org/wiki/Fibonacci_number): 
$0, 1, 1, 2, 3, 5, 8, 13, 21, 34, \dots$.
This sequence is generated by starting with the sequence $0,1$ and finding the next number 
in the sequence by adding the two previous numbers together, e.g. $0+1=\mathbf{1}$, $1+1=\mathbf{2}$, $1+2=\mathbf{3}$, 
$2+3=\mathbf{5}$, $3+5=\mathbf{8}$, etc.

**Python code for Fibonacci sequence:**
```python
nterms = 10 # number of terms
u1, u2 = 0, 1 # first two values
count = 0 # counter
while count < nterms: # while loop
       print(u1) # print values     
       nth = u1 + u2 # recurrence relation             
       u1 = u2 # update values       
       u2 = nth # update values       
       count += 1 # update counter
```
You can use [this webpage](https://skulpt.org/) to run basic python scripts.

#### Definition

```{admonition} Sequence
A **sequence** is a set of terms where order matters, written as follows:

```{math}
:label: sequencedef
    u_1, u_2, \dots, u_n
```
Here, the size of the sequence (the number of terms) is $n$.
The $i$-th term in the sequence is $u_i$ where $i = 1, 2, \dots, n$.
It must be noted that the index notation $i$ is an arbitrarily chosen, one might use other letters such as $j$, $k$ or $n$,
or even [Greek letters](https://en.wikipedia.org/wiki/Greek_alphabet) such as $\alpha$ or $\sigma$.
The same is also true for the term $u_k$, you will see other letters such as $x_k$ and $r_k$.
It is also conventional to express a series in brackets: $(u_1, u_2, \dots, u_n)$.
As we saw in the previous examples, sequences can have finite $n<\infty$ (e.g. telephone numbers) or infinite sizes 
$n \to \infty$ (e.g. Fibonacci sequence and prime numbers).

#### Expressing a sequence pattern as a formula (a recurence relation)

It is sometimes possible to express a sequence as a formula, otherwise known as a 
[recurrence relation](https://en.wikipedia.org/wiki/Recurrence_relation), which sets out the 
rule(s) to find the sequence.
For example, the Fibonacci sequence can be expressed as the formula 
```{math}
:label: recreldef
u_i=u_{i-1}+u_{i-2}
```
which specifies the $i$-th term provided we have the term for $i-1$ and $i-2$.
It is because of this formula that it is necessary to provide the first two terms of the sequence, $u_1=0$ and $u_2=1$, 
to find the rest of the sequence.
This formula can be used to find the entire, infinite sequence.
For example, the 298-th term is $u_{298} = 84885164052257330097714121751630835360966663883732297726369399$ and
the 299-th term is $u_{299} = 137347080577163115432025771710279131845700275212767467264610201$ and hence the
300-term is is $u_{300} = 222232244629420445529739893461909967206666939096499764990979600$.



Note that the formula $u_i=u_{i-1}+u_{i-2}$ will generate a different sequence to the Fibonacci sequence when the 
starting terms ar different (e.g. $u_1=10$ and $u_2=11$).
For an example, convince yourself that the formule $u_i = 2 + u_{i-1}$ provides the sequence of even numbers when
$u_1=2$ and the sequence of odd numbers when $u_1=1$.

**Pythod code for even numbers:**
```python
nterms = 10 # number of terms
u = 0 # first value
count = 0 # counter
while count < nterms: # while loop
       print(u) # print values     
       u = u + 2 # recurrence relation                   
       count += 1 # update counter
```
Can you edit this code to produce the sequence of odd numbers?

As a final example, convince yourself that the formula $u_i = 2 + 3 \times (i-2)$ generates the infinite sequence: 
$-1, 2, 5, 8, 11, 14, 17, 20, \dots$.
Note that it is not necessary to provide the first term in the sequence because the formula does not depend on the previous
term(s) in the sequence.
Also notice that the sequence grows without bound.
That is, each term is larger than each of the previous terms.
In this way the sequence grows to an infinite value as $i$ tends to infinity.

Recurrance relations, although simple, can produce surprisingly complicated behaviours.
For further reading you may like to study the [logistic map](https://en.wikipedia.org/wiki/Logistic_map):
```{math}
:label: logisticmap
u_{i+1} = r u_{i} (1 - u_i) \ ,
```
where $r$ is a constant.
This equation (which models animal population growth) openned up the field of chaos theory.








### Series

[Series](https://en.wikipedia.org/wiki/Series_(mathematics)) 
play a central role in calculus and are the main reason why we introduce sequences in the section above.

#### Definition

Series are simply defined by the sum of a sequence.
```{admonition} Series
A **series** is the sum of a sequence of terms, written as follows:

```{math}
:label: seriesdef
\sum_{i=m}^n u_i = u_1 + u_2 + \ldots + u_n \,
```
where $m \le n$, and usually equal to one ($m=1$).

We can replace the upper value $n$ with $\infty$ for an [infinite series](https://www.mathsisfun.com/algebra/infinite-series.html).
For example, the series of the infinite sequence $(u_1,u_2,u_3,\dots)$ is written as $\sum_{i=1}^\infty u_i$.
We say that $\sum_{i=m}^n u_i$ for $n < \infty$ is a partial sum because the series is partially added up to just the $n$-th term.

**Python code for the series of the sequence with recurrence relation** $u_k = u_{k-1}+\frac{1}{2}$ with $u_1=0$:
```python
n = 10 # number of terms
seq = 0 # first value of sequence
ser = 0 # first value of series
count = 0 # counter
while count < n: # while loop
       print(ser) # print series value    
       seq = seq + 0.5 # update sequence
       ser = ser + seq # update series                   
       count += 1 # update counter
```


#### Summations

Character $\Sigma$ is the Greek letter sigma, written in upper case, and denotes a [summation](https://en.wikipedia.org/wiki/Summation).
We would read the expression above as "the sum of $u_i$ from $i=1$ to $i=n$".
For example the sum of $i$ from $i=1$ to $i=4$ is $\sum_{i=1}^4 i = 1 + 2 + 3 + 4 = 10$ and the sum of $2 i$ from 
$i=1$ to $i=4$ is $\sum_{i=1}^4 2 i = 2 + 4 + 6 + 8 = 20$.
From this example it should be clear that, in general:
```{math}
:label: summationrule
\sum_{i=1}^n a u_i = a \sum_{i=1}^n u_i
``` 
where $a$ is a constant number and $u_i$ is a function of $i$ (i.e. a number that changes with the value of $i$).
We note that $\sum_{i=1}^n a + u_i$ does not equal ($\ne$) to $a + \sum_{i=1}^n u_i$. 
For example, $\sum_{i=1}^4 1+i = 2 + 3 + 4 + 5 = 14$.



### Questions 2.1

Write the following expressions using as a sum ($\Sigma$ notation) without evaluating the sum:
1. $1 + 5 + 9 + 13 + 17 +21$
2. $64-32+16-8+4-2+1$
3. $\frac{1}{3} + \frac{1}{4} + \frac{1}{5} + \dots + \frac{1}{99} $









## Arithmetic and Geometric Progressions

We now introduce the [arithmetic progression](https://en.wikipedia.org/wiki/Arithmetic_progression) (otherwise known as 
the arithmetic sequence) and the [geometric progression](https://en.wikipedia.org/wiki/Geometric_progression) 
(otherwise known as the geometric sequence).
These sequences have the nice property that their series can be solved.

[Link to a short video on arithmetic and geometric progressions](https://www.youtube.com/watch?v=Tj89FA-d0f8).

### Arithmetic progression 

#### Definition

```{admonition} Arithmetic Progression
An arithmetic progression (otherwise known as an arithmetic sequence) is a sequence of $n$ terms which all have a "common 
difference" $d$, written as follows: 

```{math} 
:label: apdef
a, a + d, a + 2d, a + 3d, \dots, a + (n-1) d 
```

where $a$ is an arbitrary number.
An example is the sequence $3,5,7,9,11,13$ in which the first term is $a=3$, the common difference is $d=2$ and the 
number of terms is $n=6$.
An infinite arithmetic progression is given by the case where $n \to \infty$.

The $i$-th term of the arithmetic progression can be expressed as the following recurrence relation:
```{math}
: label : aprrdef
u_i=a+(i-1)d
``` 
for $i=1,2,\dots,n$.


**Python code for arithmetic progression:**
```python
n = 10 # number of terms
a = 30 # first value
d = -4 # commmon difference
seq = a # first value of sequence
count = 0 # counter
while count < n: # while loop
       print(seq) # print series value    
       seq = seq + d # update sequence                 
       count += 1 # update counter
```
You can play around with the behaviouur of different arithmetic progessions by changing the values of $a$ and $d$.



#### Solving the series of arithmetic progessions

Series of arithmetic progessions can be solved (i.e. reduced to a number).
The series (or the sum) $S_n$ of an arithmetic progression with recurrence relation $u_i=a+(i-1)d$ is:
```{math}
:label: seriessol
 S_n = \sum_{i=1}^n u_i = \sum_{i=1}^n a + (i -1 ) d = \frac{n}{2} \big( 2 a + (n - 1) d \big) = \frac{n}{2} (a + L)
```
where $L = a + (n-1) d$ is the last term in the series.

Notice in equation {eq}`seriessol` that as $n$ (the number of terms) increases, the terms of arithmetic progessions grow without bound.
That is, as $n$ approaches $\infty$, the arithmetic progession approaches $\infty$ if $d>0$ and approaches $-\infty$ if 
$d<0$.
In these cases we say that the series diverges (more on this later!). 
Infinite arithmetic progressions always diverge, the proof of which can be found via 
[this link](https://math.stackexchange.com/questions/3334553/proof-that-arithmetic-series-diverges)
(although further reading is required!).

**Python code for the series of the arithmetic progression:**
```python
nterms = 10 # number of terms
a = 30 # first value
d = -4 # commmon difference
seq = a # first value of sequence
ser = a # first value of series
count = 0 # counter
while count < nterms: # while loop
       print(ser) # print series value    
       seq = seq + d # update sequence
       ser = ser + seq # update series                   
       count += 1 # update counter
```
You can use this code to convince yourself that the series of arithmetic progressions grow without bound for large $n$.

#### Proof of the solution of the series of arithmetic progressions

From equation {eq}`seriessol` write down the reversed series below the original:
```{math}
S_n = a + (a+d) + (a+2d) + \dots + \Big( a + (n-3) d \Big) + \Big( a + (n-2) d \Big) + \Big( a + (n-1) d \Big) \\
S_n = a + \Big( a + (n-1) d \Big) + \Big( a + (n-2) d \Big) + \Big( a + (n-3) d \Big) + \dots + (a+2d) + (a+d) + a \ .
```
Adding these two expressions gives:
```{math}
2 S_n =  \Big( 2 a + (n-1) d \Big) + \Big( 2 a + (n-1) d \Big) + \dots + \Big( 2 a + (n-1) d \Big) \ .
```
Since there are $n$ terms, this equations simplifies to the final result:
```{math}
S_n =  \frac{n}{2} \Big( 2 a + (n-1) d \Big)  \ .
```
[There is a legend](https://www.americanscientist.org/article/gausss-day-of-reckoning), 
that Gauss (a famous mathematician) used a similar approach as a schoolboy back in the 1780s to find the answer to 
$1+2+\dots+99+100$.


#### Questions 2.2.1

1. How many terms are in the sequence $54, 52, 50,\dots, 18$? 
2. Find the sum of the first 30 terms of the arithmetic progression with the first three terms $3,9,15$.
3. Find the sum of the arithmetic progression with first term 2, last term 10 and common difference 2.
4. Evaluate $\sum_{n=1}^{10} (5n-1)$ and $\sum_{n=100}^{1000} n$ .
5. In an arithmetic progression the 3rd term is 26 and the 8th term is 46. Find the 1st term, the common difference and $S_{50}$.
6. Find the sum of the integers between 1 and 100 which are divisible by 6.



### Geometric Progression 

#### Definition

```{admonition} Geometric Progression
A geometric progression (otherwise known as an geometric sequence) is a sequence of $n$ terms which have "common ratio" 
$r$, written as follows:

```{math}
:label: gpdef
a, a r, a r^2, a r^3, \dots , a r^{n-1}
```
where $a$ is an arbitrary number.
Using the notation for sequences in the previous section, the $i$-th term of the geometric progression is
$u_i=a r^{i-1}$ for $i=1,2,\dots,n$.
In other words, the next term in the geometric progression can be found by multiplying the previous term by the common
ratio $r$, given by the recurrence relation $u_i = r u_{i-1}$ where $u_1=a$.
An example is the sequence $24,‚àí12,6,‚àí3,1.5$ in which the first term is $a=2$, the common ratio is $r=‚àí\frac{1}{2}$ and 
the number of terms is $n=5$.

**Python code for the geometric progression:**
```python
nterms = 10 # number of terms
a = 24 # first value
r = -0.5 # commmon difference
seq = a # first value of sequence
count = 0 # counter
while count < nterms: # while loop
       print(seq) # print series value    
       seq = seq * r # update sequence                  
       count += 1 # update counter
```


#### Solving the series of geometric progessions

Like arithmetic progessions, the series of geometric progressions can be solved (i.e. reduced to a number).
The series (or the sum) $S_n$ of a geometric progression $u_i=a r^{i-1}$ is:
```{math}
:label: gpseriessol
 S_n = \sum_{i=1}^n u_i =  \sum_{i=1}^n a r^{i -1} = a \frac{1 - r^n}{1-r} 
```

**Python code for the series of the geometric progression:**
```python
nterms = 10 # number of terms
a = 24 # first value
r = -0.5 # commmon difference
seq = a # first value of sequence
ser = seq # first value of series
count = 0 # counter
while count < nterms: # while loop
       print(seq) # print series value    
       seq = seq * r # update sequence   
       ser = ser + seq # update sequence               
       count += 1 # update counter
```


#### Proof of the solution of the series of geometric progressions

Starting from equation {eq}`gpdef`, the definition of the geometric progression:
```{math}
S_n = a + a r + a r^2 + \dots + a r^{n-3} + a r^{n-2} + a r^{n-1} = a \Big(1 + r + r^2 + \dots + r^{n-3} + r^{n-2} + 
r^{n-1} \big) \ ,
```
we multiply by $r$:
```{math}
r S_n = a \Big(r + r^2 + r^2 + \dots + r^{n-2} + r^{n-1} + r^{n} \big) \ .
```
Subtracting $r S_n$ from $S_n$ and cancelling the terms provides:
```{math}
 S_n - r S_n = a \Big(1 - r^{n} \big) \ ,
```
which can be rearranged to provide the result.




#### A preliminary introduction to convergence and divergence

The behaviour of a geometric progression for "large" numbers of terms $n$ depends on the value of the common ratio $r$.
This can be deduced by the following reasoning.
If $r > 1$ or $r < -1$ (which is to say that the absolute value $\lvert r \rvert < 1$) then the $i$-th term of the
geometric progression $u_i=a r^{i-1}$ becomes a very large positive or negative number.
In this case we say that the series [**diverges**](https://en.wikipedia.org/wiki/Divergent_series).
Conversely, if $\lvert r \rvert < 1$  then $u_i=a r^{i-1}$ becomes a very small positive or negative number.
In this case we say that the series [**converges**](https://en.wikipedia.org/wiki/Convergent_series).
The topics of divergence and convergence are explored in detail later in thte course.
Thus we conclude that:
* if $\lvert r \rvert < 1$ then $S_n$ converges and approaches $\frac{a}{1-r}$ as $n\to \infty$,
* if $\lvert r \rvert > 1$ then $S_n$ diverges and approaches $\infty$ as $n\to \infty$.

#### Questions 2.2.2
1. Find the sum of the first five terms in a geometric progression with first term 27 and common ration is $\frac{2}{3}$? 
2. Evaluate $ \sum_{n=1}^\infty 729 \Big(\frac{1}{3} \Big)^{n-1}$.
3. The first term of a geometric progression is $8$. Given that the sum of the first three terms is 38, find the two possible values of the common ratio.
4. A geometric progression has first term $27$ and common ratio of $r=\frac{4}{3}$. Find the least number of terms that the sequence can have if its sum exceeds $550$.
5. By writing the recurring decimal $0.123123123\dots$ as a geometric progression, show that it can be expressed as the fraction $\frac{41}{333}$.

















## Binomial Expansion and Theorem

Throughout your scientific journey you will likely come across a time where you have to solve an equation like $(x+y)^n$.
We will know describe how you go about such a task and will highlight some interesting mathematical relations.

[Link to a short video on the binomial theorem](https://www.youtube.com/watch?v=iPwrDWQ7hPc).

### Definition of a binomial

[Polynomials](https://en.wikipedia.org/wiki/Polynomial) are expressions such as $a_0 + a_1 x + a_2 x^2 + a_3 x^3$ where 
$a_0$, $a_1$, $a_2$ and $a_3$ are the polynomial coefficients and $x$ is the variable.
They can have multiple variables (e.g. $x$ and $y$) such as $a_0 + a_1 x + a_2 x y + a_3 x y^2$. 
A [binomial](https://en.wikipedia.org/wiki/Binomial_(polynomial)) is a polynomial with two terms (e.g. x + y, x^3 + 1, 
4.3 x^5 - 2.2 y, etc).
[Binomial expansion](https://en.wikipedia.org/wiki/Binomial_theorem) refers to the computation of powers of binomials:
```{math}
:label: binomialexpansion
(x+y)^n
```
where $n$ is a real number.
Equation {eq}`binomialexpansion` is a general way to express a binomial expansion - the expansion of more complicated binomials can consider by
"swapping in" other functions for the $x$ and $y$ (e.g. $x\to 10 x^3$ and $y \to \sqrt{17} e^x$).
In this section we will investigate the binomial expansion only for the case where $n$ is a non-negative 
[integer](https://en.wikipedia.org/wiki/Integer) (e.g. $n=0,1,2,3,\dots$).


### The binomial formula

We now set out to calculate the polynomials produced by the expansion of powers of a binomial.

#### Expanding low powers of binomials by hand

It is possible to expand low powers of binomials (i.e. $n=0,1,2,3,4,5$), equation {eq}`binomialexpansion`, by hand:
```{math}
(x+y)^0 &= 1 \ , \\
(x+y)^1 &= x+y \ , \\
(x+y)^2 &= (x+y)(x+y) = x^2 + 2 x y + y^2 \ , \\
(x+y)^3 &= (x+y) (x+y)^2 = x^3 + 3 x^2 y + 2 x y^2 + y^3 \ , \\ 
(x+y)^4 &= (x+y) (x+y)^3 = x^4 + 4 x^3 y + 6 x^2 y^2 + 4 x y^3 + y^4 \ , \\ 
(x+5)^5 &= (x+y) (x+y)^4 = x^5 + 5 x^4 y + 10 x^3 y^2 + 10 x^2 y^3 + 5 x y^4 + y^5 \ .
```
You can see symmetry and patterns in the polynomials on the right hand side of the expansions.
For instance, the combined powers of the $x$'s and $y$'s are equal to the power of expansion $n$ and the total number
of terms is $n+1$.
But what is the pattern for the coefficients?
The answer to this is not trivial and is a fundamental sequence of numbers - the 
[binomial coefficients](https://en.wikipedia.org/wiki/Binomial_coefficient).

#### The binomial coefficient

```{admonition} The binomial coefficient
The binomial coefficent is defined as:   
```{math}
:label: binomcoeff
 \binom{n}{k} = \frac{n!}{k! (n - k)!} \ ,
```
where $n\le0$ and $n\le k \le 0$ are integers.
Like the number $\pi$, the binomial coefficient pops up in many unexpected places - particularly in counting problems
(the bread-and-butter of the field of combinatorics).
The binomial coefficient is the number of ways, disregarding order, that $k$ objects can be chosen from $n$ objects.
This number $\binom{n}{k}$ can be casually referred to as "n choose k", and can be expressed by $C^n_k$ and hence 
calculators encode the binomial coefficient by the "nCk" button.

#### Pascal's triangle and question 2.3.1

[Link to a video on the binomial series and Pascal's triangle](https://www.youtube.com/watch?v=XMriWTvPXHI).

A very old (first discovers in China in 11th century), but very elegant, way of calculating the binomial coefficients
(equation {eq}`binomcoeff`) can be found using 
[Pascal's triangle](https://en.wikipedia.org/wiki/Pascal%27s_trianglehttps://en.wikipedia.org/wiki/Pascal%27s_triangle).

As an introduction to this section, try to prove the following results (question 2.3.2):
```{math}
\binom{n+1}{k} &= \binom{n}{k} + \binom{n}{k-1} \\
\binom{n}{0} &= \binom{n}{n} = 1 \ .
```
Hint: use the definition of the binomial coefficent.

These results provides a [recurrence relation](https://en.wikipedia.org/wiki/Recurrence_relation) for the coefficients 
in the binomial expansion.
The method is illustrated in the figure below.
```{figure} pascal.png
---
name: pascal
---
Pascal's triangle: a table of binomial coefficients $\binom{n}{k}$.
```
In Pascal's triangle the left-most and right-most values are initially filled out according to the result 
$\binom{n}{0} = \binom{n}{n} = 1$.
Then, the recursive formula $\binom{n+1}{k} = \binom{n}{k} + \binom{n}{k-1}$ is used to fill out the rest of each row.
The trick is that each value is calculated by adding the two values from the row above that are in the same column and 
the preceding column.

Pascal's triangle provides a quick way of finding binomial coefficients by hand. 
For instance, to compute the expansion of $(x+y)^6$, we can read off the coefficients from the 6th row in Pascal's triangle:
```{math}
(x+y)^6 = x^6 + 6 x^5 y + 15 x^4 y^6 + 20 x^3 y^3 + 15 x^2 y^4 + 6 x y^5 + y^6 \ .
```



#### Factorials

We breifly note that the "$!$" symbol represents a [factorial](https://en.wikipedia.org/wiki/Factorial) of an integer number.
A factorial of integer number $n$ is defined as the product of all the numbers from $1$ to $n$: 
$n! = n \times (n-1) \times (n-2) \times \dots \times 2 \times 1$.
The special cases of factorials are $0! =1$ and $1!=1$.
The special cases of the binomial coefficient (equation {eq}`binomcoeff`) are thus $\binom{n}{0}= 1$, $\binom{n}{1} = n$, $\binom{n}{n}=1$ and 
$\binom{n}{n-1} = n$.
These examples highlight a nice symmetrical property of the binomial coefficient: $\binom{n}{k} = \binom{n}{n-k}$ (where
$0 \le k \le n$).

[Link to a video on factorials](https://www.youtube.com/watch?v=pxh__ugRKz8).

#### Statement of the binomial formula

Knowing the binomial coeffient allows us to find the solution to $(x + y)^n$ for all positive integers $n=0,1,2,\dots$.
With much ado the binomial formula is as follows.
```{admonition} The binomial formula
The binomial formula (otherwise known as the binomial theorem) is defined as:   
```{math}
:label: binomform
 (x+y)^n = \sum_{k=0}^n \binom{n}{k} x^k y^{n-k} =  \binom{n}{0} x^0 y^n +  \binom{n}{1} x^1 y^{n-1} + \dots +
 \binom{n}{n-1} x^{n-1} y^{1} + \binom{n}{n} x^n y^0 \ .
```
You are not required to be familiar with 
[the details of its derivation](https://math.stackexchange.com/questions/119480/derivation-of-binomial-coefficient-in-binomial-theorem) 
but do need to be able to apply the formula to compute binomial expansions.
This formula also shows you why $\binom{n}{k}$ are called binomial coefficients - because they are the coefficients of
the polynomial produce by the expansion of powers of binomials.
Reassure yourself of the utility of this formula by timing yourself expanding $(x+y)^6$ by hand and then by the binomial 
formula.
For further reading you may like to explore the [multinomial theorem](https://en.wikipedia.org/wiki/Multinomial_theorem)
which is a generalisation of the binomial formula to polynomials.


#### Questions 2.3.2
1. Calculate $(x+y)^9$ using the Binomial theorem.
2. Calculate the coefficient of the term in $x^2 y^3$ in the expansion $(2 x - 3)^5$.
3. Find the constant term in the expansion $\big(x^2 - \frac{1}{x} \big)^9$.
4. Expand $(1+x-x^2)^7$ in ascending powers of $x$ up to and including the term in $x^3$.
















## Limits

The mathematics of [limits](https://en.wikipedia.org/wiki/Limit_(mathematics)) is used to describe the behaviour of a 
function or sequence that is not AT a point, but approaching it. 
For example, in the geometric progression we saw that the sequence approaches either a finite number (converges) or
infinite number (diverges) as the number of terms appraoches infinity.
In what comes next, we will be interested in calculating the "limit" of (i) the terms in a sequence $u_k$ as 
$k \to \infty$, and (ii) the value of a function $f(x)$ as $x \to c$ where $c$ can be a finite or infinite number.
We may distinguish the cases where:
* the function and terms in a sequence **diverge** to an infinite value (blow up to $\pm \infty$),
* the function and terms in a sequence **converge** to a finite value.

[Link to a video introducing the concept of a limit](https://www.youtube.com/watch?v=riXcZT2ICjA).



### Limits of functions

The [limits of a function](https://en.wikipedia.org/wiki/Limit_of_a_function) are best illustrated by example.


#### Example 1

We start with a trivial example, by considering the function $f(x) = x^2$ near to the point (2,4). 
```{figure} x_squared.png
---
name: x_squared
---
A plot of $f(x)=x^2$ together with the point $(2,4)$.
```
In this example, it is apparent that we can trace along the $x^2$ curve towards the point, from either direction. 
Mathematically, we say that we can make $f(x)$ arbitrarily close ("as close as you like") to 4 by making $x$ 
sufficiently close to 2. 
We write 
```{math}
\lim_{x \to 2} x^2 = 4
```
and we say that "the limit of $x^2$ as $x$ tends to (approaches) 2 is equal to 4".
In fact, for the squared function, it is clear that 
```{math}
\lim_{x \to c} f(x) = f(c)
```
for all $c$.
However we will see that this behaviour does not apply for all functions.

We may also consider the limit of a function $f(x)$ as its argument $x$ becomes "very large". 
For instance, we can say that $\lim_{x\to\infty} x^2 = \infty$ since $x^2$ can be made arbitrarily large by making $x$ 
"big enough". 
For instance, we can make $x^2$ larger than $10^{998}$ by making $x$ larger than $10^{499}$.

We would read the expression by saying: "the limit of $x^2$ as $x$ tends to infinity is infinity", though it does not 
actually reach infinity.


#### Example 2

Whilst the limit of $x^2$ for large $x$ is non-finite, there are other functions which approach a finite value as 
$x \to \infty$, and also functions which approach a non-finite value whilst $x$ remains finite. 
For example, consider the behaviour of $f(x) = \frac{1}{x}$, illustrated in the plot below. 
```{figure} reciprocal_x.png
---
name: reciprocal_x
---
A plot of $f(x)= \frac{1}{x}$.
```
In this case, as $x$ becomes very large, $f(x)$ approaches zero.
We write that
```{math}
\lim_{x \to \infty} \frac{1}{x}&= 0^+ \\
\lim_{x \to - \infty} \frac{1}{x}&= 0^- \ .
```
The $0^+$ and $0^‚àí$ have been used here to indicate that the function "tends to zero from above/below" as $x$ tends to 
positive and negative infinity respectively.

Near to $x=0$, the behaviour of $\frac{1}{x}$ is different to what we have seen so far:
* As $x$ tends to zero from above (from the right), the graph shoots off to positive infinity, but...
* As $x$ tends to zero from below (from the left), the graph shoot off to negative infinity.

#### The one-sided limit

The previous example motivates the idea of a [one-sided limit](https://en.wikipedia.org/wiki/One-sided_limit).
We write that
```{math}
\lim_{x \to 0^+} \frac{1}{x} &= + \infty \\
\lim_{x \to 0^-} \frac{1}{x} &= - \infty \ .
```
Since the left- and right- limits are not the same, then we cannot meaningfully refer to "the limit" without providing 
a direction, so the result for $\lim_{x \to 0} \frac{1}{x}$ is undefined. 
We say that the function is discontinuous at $x = 0$, though it is 
"[piecewise continuous](https://math.stackexchange.com/questions/1968943/whats-the-difference-between-continuous-and-piecewise-continuous-functions)" 
on each of the pieces either side of $x=0$.

Another example of a piecewise continous function is the [Heaviside function](https://en.wikipedia.org/wiki/Heaviside_step_function), 
which we define as:
```{math}
H(x) = \begin{cases}
1 \ \ &\text{if} \ \ \ x > 0 \\
0 \ \ &\text{if} \ \ \ x < 0 
\end{cases} \ ,
```
although it may be defined otherwise (e.g. with $H(0)=\frac{1}{2}$).
A plot of this function is shown below. 
It has a finite jump discontinuity at $x=0$.
```{figure} heaviside.png
---
name: heaviside
---
A plot of the Heaviside function $H(x)$.
```


### Limits of sequences 

#### Definition 

The [limit of a sequence](https://en.wikipedia.org/wiki/Limit_of_a_sequence) is the value that the terms of a sequence 
approaches (or tends to) as the number of terms approaches infinity, written as $k \to \infty$ if $k$ were the index variable.
```{admonition} The limit of a sequence
For a sequence $(u_1, u_2, u_3, \dots)$, the limit of a sequence is written as   
```{math}
 \lim_{k \to \infty} u_k \ .
```
We say that a number, say $U$, is the limit of a the sequence $(u_1, u_2, u_3, \dots)$ if the numbers of the sequence
$u_k$ approach $U$ as $k\to\infty$.
We say that the limit of the sequence diverges if $\lvert U \rvert =\infty$ and converges if $\lvert U \rvert < \infty$.

#### Similarity to limits of a function

It is important to note that similarity between the limits of a sequence and a function.
A function $f(x)$ for real number $x$ will have the same limit as the sequence $u_k = f(k)$ for integer number $k$.
For example $f(x) = x^2$, the limit $\lim_{x \to \infty} f(x) = \infty$ is the same as the limit (infinite) of the 
sequence with terms $u_k = k^2$, $(1, 2, 4, 16, \dots)$.

The key difference is that when we refer to the limit of a sequence we always mean the limit of the terms $u_k$ as the
numbers of terms go to infinity $k\to\infty$.
This is not the case for the limit of functions where the variable (i.e. $x$) can go to any number.

Consider another example from the previous section, the limit of the infinite sequence with terms 
$u_k = \frac{1}{k}$ for $k=1,2,\dots$:
```{math}
1, \frac{1}{2}, \frac{1}{3}, \frac{1}{4}, \dots 
```
is $0$ in the same way that the limit of the functon $\frac{1}{x}$ is zero, $\lim_{x\to\infty} \frac{1}{x} = 0$.


#### Infinite series as limit of partial sums

The value of a infinite series can be defined as the value of the limit (if exists) of the sequence defined by it partial 
sums, that is:
```{math}
\sum_{k=1}^\infty u_k = \lim_{n \to \infty} \sum_{k=1}^n u_k \ .
```
Alternatively we could write that $S_n = \sum_{k=1}^n u_k$ and that $\lim_{n \to \infty} S_n = S_\infty$.

For example, consider the series of the geometric progression $(a, a r, a r^2, a r^3, \dots , a r^{n-1})$ where $1 > r > 0$ 
and $a$ is an arbitrary constant:
```{math}
S_n = \sum_{k=1}^n a r^{k -1} = a \frac{1 - r^n}{1-r}
```
The infinite series of the geometric progression for $n \to \infty$ is thus:
```{math}
S_\infty = \lim_{n \to \infty} S_n =  a \lim_{n \to \infty} \frac{1 - r^n}{1-r} = \frac{a}{1-r} \ ,
```
because $\lim_{n\to \infty} r^n = 0$ since $r<1$.



### Combinaton of limits

It is useful to know how to solve the limit of combinations of functions (or so called functions of functions) such as
```{math}
\lim_{x \to c} \frac{f(x)}{g(x)} \ ,
```
where $c$ will can be any number such as $0$, $1$ or $\infty$.

The approach we take to solve these depends on whether the limits of the inidividual functions $\lim_{x \to c} f(x)$ 
and $\lim_{x \to c} g(x)$ are finite or infinite.

#### Functions that tend to finite values: the combination theorem for limits

First consider the case where the limit of all the functions are finite.
If and only if the limits of the individual functions are FINITE then we can use the combination theorem to solve the combination
of functions.
```{admonition} The combination theorem for limits
If the limits $\lim_{x \to c} f(x)$ and $\lim_{x \to c} g(x)$  are **finite** then, 
```{math}
 &\lim_{x \to c} \Big( \alpha f(x) + \beta g(x) \Big) = \alpha \lim_{x \to c} f(x) + \beta \lim_{x \to c} g(x) \ ,\\
&\lim_{x \to c} f(x) g(x) = \lim_{x \to c} f(x) \lim_{x \to c} g(x) \ ,  \\
&\lim_{x \to c} \frac{f(x)}{g(x)} \ ,
```
where $\alpha$ and $\beta$ are constants.
To stress the point again, the combination theorem for limits can only be used if the limit of every function is finite.

As an example, consider the function:
```{math}
\lim_{x \to 0} \frac{x^2}{(x+1)^3 - (x-1)^3} \ . 
```
Since the limits of each of the individual functions are finite: $\lim_{x \to 0} x^2 = 0$, $\lim_{x \to 0} (x+1)^3 = 1$ 
and $\lim_{x \to 0} (x-1)^3 = -1$, we can use first and third statment of the combination theorem to rewrite and solve
the equation as:
```{math}
 \lim_{x \to 0} \frac{x^2}{(x+1)^3 - (x-1)^3} &= \frac{\lim_{x \to 0} x^2}{\lim_{x \to 0} \Big((x+1)^3 - (x-1)^3}\\
 &= \frac{\lim_{x \to 0} x^2}{\lim_{x \to 0} (x+1)^3 - \lim_{x \to 0}(x-1)^3}\\
 & = \frac{0}{1 - (-1)}
```
So we can conclude the limit of the function is $0$.


#### Functions that tend to infinite values

We now consider the case where the limit of all the individual functions are infinite, such as
$\lim_{x\to \infty} x^2 = \infty$ and $\lim_{x\to 0^-} \frac{1}{x} = -\infty$.

The approach we take can be illustrated by the followinig two examples:

##### Example 1

```{math}
 \lim_{x \to \infty} ( x^2 - x ) \ . 
```
This limit appears to "go like" $\infty - \infty$, so you would be forgiven for thinking this result is zero.
On the other hand, there is a sense in which $x^2$ is "much bigger" than $x$ and so it dominates this expression. 
That is $x^2$ "blows up faster" than $x$ as $x\to \infty$.
Indeed, if you try subsitute a large value of $x$ into the function $(x^2 - x)$ you may infer that function can get 
arbitrarily large by making $x$ sufficiently large.
So this limit appears to be infinity.

Another way to approach this problem is to factorise $(x^2 - x) = x (x-1)$; both $x \to \infty$ and $x-1 \to \infty$  
as $x\to\infty$.


##### Example 2

```{math}
 \lim_{x \to \infty} \frac{x + \sqrt{x + 2} }{4 x} \ .
```
The second limit "goes like" $\frac{\infty}{\infty}$, but the answer is not one.
To solve this limit we consider the behaviour of the numerator and denominator separately.
We note that the function $x$ is "much much" greater than $\sqrt{x + 2}$ for large $x$ (i.e. $x >> \sqrt{x + 2}$) so we 
say that the numerator "goes like" $x$ for large $x$.
The denominator simply "goes like" 4ùë•, so the fraction in the limit "goes like" $ \frac{x}{4 x} = \frac{1}{4}$. 
Again, you may convince yourself of this by taking some large values of $x$ on your calculator - 
though note that your calculator may not be able to handle the ratio if you make the values too large.

Another approach you may take is to simplify the function first:
```{math}
 \lim_{x \to \infty} \frac{x + \sqrt{x + 2} }{4 x} &= \frac{1 + \frac{\sqrt{x +2 }}{x} }{4} \\
 & = \frac{1 + \sqrt{ \frac{1}{x} + \frac{2}{x^2}  }}{4} \ .
```
Because $\lim_{x\to\infty} \frac{1}{x} = \lim_{x\to\infty} \frac{2}{x^2} = 0$, we can see we also arrive at the solution
of $\frac{1}{4}$.
As an exercise, convince yourself of the following result:
```{math}
 \lim_{x \to 0} \frac{x + \sqrt{x + 2} }{4 x} = \infty \ .
```




##### Summary

From the 2 examples above we illustrate that the solutions can be found be determing the individual function(s) (which
may be constant values) that dominate in the limit.
It most cases it is useful to simply the equation before tackling the limit.

It must be noted that fractions which "go like" $\frac{\infty}{\infty}$ do not necessarily approach a finite limit. 
For instance, the result $\lim_{x \to \infty} \frac{x+2}{x^2 - x}$ is equal to zero, since the degree of the denominator 
is larger than the degree of the numerator and it dominates. 
That is, the denomiator "blows up faster" than the numerator.



### Questions 2.4

Find the following limits:
1. $\lim_{x\to\infty} \frac{x+2}{x^2-2}$.
2. $\lim_{x\to\infty} \frac{x-2}{x+2}$.
3. $\lim_{x \to \infty} \big( \sqrt{x^2-2} - \sqrt{x^2+x} \big)$.






## Method of Differences

The method of differences provides a way to find a finite series (sum of a sequence) by using the difference of similar sums 
to compute the desired result.
This is a handy trick to find the value of partial (finite) sums.

This is best illustrated by example.

[Link to a short video](https://www.youtube.com/watch?embed=no&v=AAxES-zFuxQ).


### Illustrative example

Say we want to compute the partial sum:
```{math}
\sum_{r=1}^N r \ .
```
One way to approach this is to consider the following two series:
```{math}
\sum_{r=1}^N r (r+1) &= 1 \times 2 + 2 \times 3 + 3 \times 4 + \dots + (N-1) \times N + N \times (N+1) \\
\sum_{r=1}^N r (r-1) &= 1 \times 0 + 2 \times 1 + 3 \times 2 + \dots + (N-1) \times (N-2) + N \times (N-1) \ . 
```
It can be seen that in general the $n$-th term in the second series is the same as the $(n-1)$-th term in the first 
series. 
Therefore, if we calculate the difference between the two sums, almost all of the terms cancel, to leave:
```{math}
\sum_{r=1}^N \Big( r (r+1) - r (r-1) \Big) = N \times (N-1) \ .
```
Observing that $r (r+1) - r (r-1) = 2 r$ then gives us the following result:
```{math}
 \sum_{r=1}^N r = \frac{N(N+1)}{2} \ .
```
We note that this result could also have been found using the formula for an arithmetic progression with first term 1 
and common difference 1.



### Rewriting the summation index

#### Demonstration of utility
It is possible to demonstrate the cancellation of terms without writing out the terms in the series. 
Using the example above, we could rewrite:
```{math}
 \sum_{r=1}^N r (r-1) = \sum_{r=0}^{N-1} (r+1) r = 0 + \sum_{r=1}^N r (r+1) - N (N+1) \ ,
```
and therefore:
```{math}
\sum_{r=1}^N \Big( r (r+1) - r (r-1) \Big) = \sum_{r=1}^N  r (r+1) - \sum_{r=1}^N  r (r+1)  + N(N+1)  = N(N+1) \ .
```

#### Generalisation
In general, rewriting the summation index provides:
```{math}
\sum_{r=1}^N f(r+c) = \sum_{r=1+c}^{N+c} f(r) \ ,
```
where $f(r)$ is an arbitrary function of summation index $r$ and $c$ is a postive integer number.
This can be also used for negative integer values:
```{math}
\sum_{r=1}^N f(r-c) = \sum_{r=1-c}^{N-c} f(r) \ .
```
You will find that this technique can drastically simplify summations we wish to solve.
For example:
```{math}
\sum_{r=1}^N \frac{2^{r+5}}{ \sqrt{r+5}} = \sum_{r=6}^{N+5} \frac{2^{r}}{ \sqrt{r}} \ .
```

#### Example 
Consider the difference between the following two sums:
```{math}
D = \sum_{r=1}^N \frac{e^r}{ (r+1) (r+2) } - \sum_{r=1}^N \frac{e^{r+2}}{(r+3) (r+4)} \ .
```
Notice that the function within summation on the right $\frac{e^{r+2}}{(r+3) (r+4)}$ is the same as that on the left
$\frac{e^r}{ (r+1) (r+2) }$ except that the summation index is greater by a value of 2.
Thus we can rewrite the summation index of the right sum to provide:
```{math}
D = \sum_{r=1}^N \frac{e^r}{ (r+1) (r+2) } - \sum_{r=3}^{N+2} \frac{e^r}{(r+1) (r+2)} \ .
 ```
Now we have the same function of the index $r$ but with different values of the summation index.
To solve the equation we simply "take out" the index values that are not common, i.e. $r=1,2$ on the left sumation
and $r=N+1,N+2$ on the right summation:
```{math}
D & = \frac{e^1}{2\times 3} + \frac{e^2}{ 3 \times 4} + \sum_{r=3}^N \frac{e^r}{ (r+1) (r+2) } - 
\sum_{r=3}^N \frac{e^r}{ (r+1) (r+2) } - \frac{e^{N+1}}{(N+2)\times (N+3)}  - \frac{e^{N+2}}{(N+3)\times (N+4)} \\
&=\frac{e^1}{2\times 3} + \frac{e^2}{ 3 \times 4} - \frac{e^{N+1}}{(N+2)\times (N+3)}  - \frac{e^{N+2}}{(N+3)\times (N+4)} 
```
Note: if you struggle with rewriting the summation index, it's ok to just write out the terms in the series and 
demonstrate the cross-cancellation.
 


### Questions 2.5

1. Use the result $r^2 (r+1)^2 - (r-1)^2 r^2 = 4 r^3$ to calculate $\sum_{r = 1}^{N} r^3$.
2. By using [partial fractions](https://www.mathcentre.ac.uk/resources/uploaded/mc-ty-partialfractions-2009-1.pdf) to 
rewrite the summand, show the result:
```{math}
\sum_{r = 1}^n \frac{2}{r (r+1) (r+2)} = \frac{1}{n+2} - \frac{1}{n+1} + \frac{1}{2} \ . 
```






## Convergence and Divergence


### Fundamental concept

We have already seen in the sections on geometric progression and method of differences that some series can approach 
a finite value as the number of terms grows infinitely large.
Series of this type are called **convergent**. 
For instance, the series $\sum_{n=1}^N \left(\frac{1}{4}\right)^n$ approaches (converges) to $\frac{1}{3}$ as $N$ approaches $\infty$
($N \to \infty$).


On the other hand, the series $\sum_{n=1}^N n$ can be made as big as we like by adding additional terms.
We say that this series **diverges**. 
We may start to understand this behaviour by looking at what happens to the size of the terms in the long run.
In the series $\sum_{n=1}^N n$, the terms in the series are themselves growing, but this growing behaviour is not 
necessary for the series to diverge. 
For instance, in the series $\sum_{n=1}^N \frac{1}{4}$ the terms remain finite, but we can make the sum as big as we 
like by adding more terms; so this series also diverges.

Less obviously, if we look at the series $\sum_{n=1}^N \frac{n^2}{4n^2 + 3 n + 1}$ then it may be shown that the terms 
($\frac{n^2}{4n^2 + 3 n + 1}$) in the series approach as $n \to \infty$. 
This means that in the long run the series starts to resemble$\sum_{n=1}^N \frac{1}{4}$. 
Hence, this series also diverges.


### Preliminary test for divergence

#### Definition

These ideas of the previous section lead us to the following "preliminary test for divergence".
```{admonition} Preliminary test for divergence
If the terms $u_n$ in a series do not approach zero as $n \to \infty$ then the series diverges.
```
Note well that the preliminary test cannot conclusively identify a series as convergent, we require further tests in 
our toolbox.
However it does test whether a series is divergent.

This test should intuitively make sense; if the terms in a infinite sequences diverges then the series (the sum of the
sequence) must also diverge. 
However, the case where the terms in the series approach zero may not match our intuition. 
It is NOT necessarily true that if the terms in the series approach zero then the series will converge.


#### Example: the harmonic series

For example, consider the [harmonic series](https://en.wikipedia.org/wiki/Harmonic_series_(mathematics)) 
```{math}
\sum_{n=1}^N \frac{1}{n} \ .
```
As $n \to \infty$, the denominator of the fraction becomes arbitrarily large and so the fraction shrinks away to zero. 
It may appear, then that the series will converge since in the end we are just adding on a bunch of nothings!
However, a clever re-grouping of the terms shows that the series is divergent. 
[The trick](https://en.wikipedia.org/wiki/Harmonic_series_(mathematics)#Comparison_test), which was proved in 1350 by 
the French Mathematician Nicole Oresme, relies on grouping the terms in the following way:
```{math}
\sum_{n=1}^N \frac{1}{n} = \frac{1}{2} + \Big( \frac{1}{3} + \frac{1}{4} \Big) +
 \Big( \frac{1}{5}  + \frac{1}{6} + \frac{1}{7}  + \frac{1}{8} \Big) + \dots
```
so that each new group has twice as many terms as the previous one.
It can be shown that each group of terms is then bigger than $\frac{1}{2}$, and so the sum must be larger than 
$\sum_{n=1}^\infty \frac{1}{2}$, which diverges.
Hence, this sum also diverges.

On the other hand, the terms in the series $\sum_{n=1}^\infty \frac{1}{4^n}$ approach zero, and this sum converges.
The preliminary test cannot distinguish between these cases, and so further tests are needed to determine the behaviour 
of the sum if the terms approach zero in the long run.
One such test is D'Alembert's ratio test, outined below. 



### D'Alembert's ratio test

#### Prelimaries


[D'Alembert's ratio test](https://en.wikipedia.org/wiki/Ratio_test) (sometimes simply referred to as the "ratio test")
looks at the **ratio** of each terms of an infinite sequence of numbers ($u_1,u_2,u_3,\dots$)
```{math}
:label: DAratio
 \rho = \Bigg\lvert \frac{u_{n+1}}{u_n} \Bigg\rvert \ ,
```
to determine if the infinite series converges or diverges.
The notation |‚Ä¢| is used for the magnitude (otherwise known as the absolute value, e.g. $\lvert -2 \rvert = 2$) of the 
expression - the test thus only considers the relative size of the terms in the series. 
D'Alembert's ratio test is more powerful than the preliminary test, but is usually a bit harder to apply and so we should use the 
preliminary test first (the clue is in the name!).


#### Statement

To determine if an infinite series $\sum{n=1}^\infty u_n$ diverges ($\sum{n=1}^\infty u_n = \infty$) of converges
($\sum{n=1}^\infty u_n<\infty$) we look at the behaviour of the ratio in equation {eq}`DAratio` in the limit 
$n \to \infty$, written as:
```{admonition} D'Alembert's ratio test
For the magnitude of the ratio of sucessive terms in a series, 
$\rho = \lim_{n \to \infty} \lvert \frac{u_{n+1}}{u_n} \rvert$, then if:
* $\rho < 1$ then the series converges absolutely,
* $\rho>1$ then the series diverges absolutely,
* $\rho=1$ then the test is inconclusive.
```
Note well that the $n+1$ term is the numerator and the $n$ term is the denominator!

Intuitively, D'Alembert's ratio test tells us that if the ratio of suquential terms is less than 1 then the
terms are **shrinking** and hence the series converges.
If the converse is true the the terms are **growing** and hence the series diverges. 

The proof of the ratio test (not shown here) relies on comparing the series to a convergent/divergent geometric progression.

Cases where the ratio test is inconclusive will not be dealt with in this course, although there are further tests that 
can be used for such problems. 
One of the most straightforward to use is the [sandwich theorem](https://en.wikipedia.org/wiki/Squeeze_theorem) 
(also known as the "squeeze theorem"), which can be used not only to demonstrate that a series is convergent, but also 
to find upper and lower bounds for the value of the sum or even to find the value of the sum exactly.

#### Example

We will use D'Alembert's ratio test to determine whether $\sum_{k=1}^n \frac{k^2}{k!}$ converges.

Letting $u_k = \frac{k^2}{k!}$, the ratio $\frac{u_{k+1}}{u_k}$ simplifies to:
```{math}
\frac{u_{k+1}}{u_k} &= \frac{(k+1)^2}{k^2} \frac{k!}{(k+1)!} \\
&= \frac{(k+1)^2 k!}{k^2 (k+1) k!} \\
& = \frac{k+1}{k^2} \ .
```
Here we have used the definition of the [factorial](https://en.wikipedia.org/wiki/Factorial) to write $(k+1)! = (k+1) k!$.
By recalling the combination theorem, we have that:
```{math}
\rho = \lim_{k\to\infty} \Bigg\lvert \frac{u_{n+1}}{u_n} \Bigg\rvert = \lim_{k \to \infty} \frac{k+1}{k^2} = 0 \ ,
```
and thus the series converges absolutely.

Note:
1. It is very important to get the algebra correct in the division step. This is often done carelessly and can cost a lot of marks.
2. The limit step is important! We are interested to know what happens to the terms in the series in the long run - i.e. as $n \to \infty$. The limit must be explicitly taken!


### Questions 2.6

Use D'Alembert's ratio test to determine if the following series converges:
1. $\sum_{k=1}^n \frac{(2 k)!}{2^k k!}$,
2. $\sum_{k=1}^n \frac{(-1)^k}{k} = 1 - \frac{1}{2} + \frac{1}{3} - \frac{1}{4} + \dots$.


### Comparison Test

#### Prelimaries

This test aims to compare the terms in our unknown series with terms of a well understood series - typically we will compare to series involving powers of 2 here.  If for instance we write a geometric series that term by term is greater than or equal to the terms in an unknown series, we can typically argue that our unkown series converges and even offer an upper limit on the total value of the series.  

#### Statement

We argue that a series $S_1 = \sum_n a_n$ can be shown to converge if there exists a series $S_2 = \sum_n b_n$ such that for all terms $b_n \geq a_n$ where series $S_2$ is known to converge, therefore series $S_1$ must also converge.  

#### Example
Show that the following series converges
```{math}
S_1 = \frac{1}{2^2} + \frac{1}{4^2} + \frac{1}{6^2} + \frac{1}{8^2} + \frac{1}{10^2} + \frac{1}{12^2} + \frac{1}{14^2} + \frac{1}{16^2} +\dots = \sum_n^\infty \frac{1}{(2n)^2}

```
We can compare this series to the following series, which we can find by rounding down every denominator to nearest power of two (before applying the squared):
```{math}
S_2 = \frac{1}{2^2} + \frac{1}{4^2} + \frac{1}{4^2} + \frac{1}{8^2} + \frac{1}{8^2} + \frac{1}{8^2} + \frac{1}{8^2} + \frac{1}{16^2} +\dots
```

We can see that every term in $S_2$ is greater than or equal to every term in $S_1$, therefore if both $S_1, S_2$ converge, the value of $S_2 > S_1$.

We can rewrite $S_2$ by collecting together like terms:
```{math}
S_2 = \frac{1}{2^2} + \frac{2}{4^2} + \frac{4}{8^2} + \dots = 1 + \frac{1}{2^2} + \frac{1}{2^3} + \frac{1}{2^4} + \dots
```
which we can see is a geometric series, with $a = \frac{1}{2^2}$ and $r = \frac{1}{2}$, which means that 

```{math}
S_2 = \frac{1/2^2}{1 - 1/2} = \frac{1}{2}
```
and since $S_2$ converges, then by the comparison test $S_1$ also converges.

The comparision test can also be used to put bounds on the values of some series, since the rounding down procesure can often be followed by a rounding up procecure, which will give us upper and lower bounds for a series.  For the sum $S_1$, we can have:
```{math}
S_3 = \frac{1}{2^2} + \frac{1}{4^2} + \frac{1}{8^2} + \frac{1}{8^2} + \frac{1}{16^2} + \frac{1}{16^2} + \frac{1}{16^2} + \frac{1}{16^2} +\dots
```
which we can see gives every term less than or equal to every term in $S_1$.  By a similar process to finding the value of $S_2$ we find:
```{math}
S_3 = \frac{1}{2^2} + \frac{1}{4^2} + \frac{2}{8^2} + \frac{4}{16^2} + \dots = 1 + \frac{1}{2^2} + \frac{1}{2^4} + \frac{1}{2^5} + \frac{1}{2^6} + \dots
```
and if we skip the first terms here, this is also a geometric series, with $a = \frac{1}{2^4}$ and $r = \frac{1}{2}$, therfore:
```{math}
S_2 = \frac{1}{2^2} + \frac{1/2^4}{1 - 1/2} = \frac{3}{8}
```
and since $S_2 > S_1 > S_3$ we have $\frac{4}{8} > S_1 > \frac{3}{8}$.

### Absolute v's Conditional Convergence

See also Chapter 25 of "The Calculus Story: A Mathematical Adventure" by David Acheson.

#### Motivation
D'Alembert's ratio test looks at the absolute value of the ratio to determine whether the terms are growing or decaying 
in size without recourse to their sign. 
This allows us to make a statement about the [absolute convergence](https://en.wikipedia.org/wiki/Absolute_convergence) 
of the series.
That is, series that converge to a single, finite number.
However there are series that do not absolutely converge, but can be "rearranged" to converge to any value at all, 
including $\infty$ or $-\infty$.
This statement should not be immediately clear as it is quite unintuitive.
These series are called [conditionally convergence](https://en.wikipedia.org/wiki/Conditional_convergence), and are 
explained in what follows.

#### Explanation of conditional convergence

```{admonition} Conditional convergence
If a series is **absolutely convergent** then it will converge to the same value for any rearrangement of the terms. 
If the series is not absolutely convergent, then it may be **conditionally convergent**, in which case it can be summed 
to an arbitrary value (finite or infinite) depending on the arrangement of the terms in the series.
```
Conditionally convergent series have terms with alternating signs.
In some of the previous examples that we looked at, all of the terms in the series were the same sign 
(all positive or all negative).
In these cases: (i) we did not need to distinguish between absolute and conditional convergence, and (ii)
looking at the relative size of the terms (as in D'Alembert's ratio test) were sufficient to determine the 
convergence properties.
But in the case where the signs in the series alternate, the behaviour is much more peculiar/subtle. 

#### Example

Consider the [alternating harmonic series](https://en.wikipedia.org/wiki/Harmonic_series_(mathematics)#Alternating_harmonic_series):
```{math}
\sum_{k=1}^n \frac{(-1)^{k+1}}{k} = 1 - \frac{1}{2} + \frac{1}{3} - \frac{1}{4} + \frac{1}{5} - \frac{1}{6} + \dots \ ,
```
It can be shown (see later a chapter on Taylor series) that this series converges to the natural logarithm of 2, $\ln(2)$.

However, a regrouping of the terms gives:
```{math}
\sum_{k=1}^n \frac{(-1)^k}{k} &= \Big( 1 - \frac{1}{2} \Big)  - \frac{1}{4} + \Big(\frac{1}{3} - \frac{1}{6}\Big) - \frac{1}{8} + 
\Big( \frac{1}{5} - \frac{1}{10} \Big) - \frac{1}{12} + \dots \\
&= \frac{1}{2} - \frac{1}{4} + \frac{1}{6} - \frac{1}{8} + \frac{1}{10} - \frac{1}{12} \\
&= \frac{1}{2} \Big( 1 - \frac{1}{2} + \frac{1}{3} - \frac{1}{4} + \frac{1}{5} - \frac{1}{6} + \dots \Big) \ ,
```
which is half of the original series!

In fact, it can be shown that this series can be made equal to any value by a suitable rearrangement of the terms...

This series is an example of a [conditionally convergent](https://en.wikipedia.org/wiki/Conditional_convergence) series 
-i.e. a series that does not converge absolutely, but can be made to converge to (any) value which depends on the 
arrangement of the terms.
This is known as [Riemann's paradox](https://en.wikipedia.org/wiki/Riemann_series_theorem).

[Here is a short video explanation](https://www.youtube.com/watch?embed=no&v=-EtHF5ND3_s).

In this course we will only look at absolute convergence.








## Solutions for this chapter

### Questions 2.1

1. $\sum_{i=1}^6 (4n - 3)$ or $\sum_{i=0}^5 (4n + 1)$.

2. $\sum_{i=0}^6 (-1)^n 2^{6 - n}$ or $\sum_{i=0}^6 (-1)^n 2^n$, by reversing the order of the summation.

3. $\sum_{i=3}^{99} \frac{1}{n}$ or $\sum_{i=1}^{97} \frac{1}{n+2}$.
Note: other answers are possible!


### Questions 2.2.1

1. This is an arithmetic progression (AP) with first term $a=54$, common difference $d=-2$, and last term $L=18$.
Since $L = a + (n-1)d$, we have $n = \frac{18-54}{-2} = 19$ terms.

2. For an AP with first term $a=3$, and common difference $d=6$, the sum of the first $30$ terms is given by $S_{30} = \frac{n}{2}(2a+(n-1)d = \frac{30}{2} (6 + 29 \times 6) = 2700$.

3. For this AP the first term is $a=2$, the common difference is $d=2$.
The last term is given by $a+(n-1)d=10$, so we find that $n=5$.
The sum is given by $S_5 = \frac{5}{2} (2+10) = 30$.

4. The first expression is an AP with first term $a=4$, last term $L=49$ and $n=10$ terms. The sum is $\frac{n}{2}(a+L)=265$.
The second expression is an AP with first term $n=100$, last term $L=1000$ and $n=901$ (take care!).
The sum is $\frac{n}{2} (a+L) = 495550$.
You could also calculate this using $\frac{1000}{2}(1+1000)‚àí\frac{99}{2}(1+99)$.

5. Let the first term of this AP be denoted by $a$, and the common difference be denoted by $d$. 
We have that $a+2d=26$ and $a+7d=46$.
Solving these two equations simultaneously gives $a=18$ and $d=4$.
The sum of the first $50$ terms is given by $S_{50}=\frac{50}{2}(2a+49d)=5800$.

6. The series is given by $S=6+12+18+...+96 = \sum_{n=1}^{16} 6 n$.
This is the sum of an AP with first term $a=6$, last term $L=96$ and $n=16$ terms.
The result is $S= \frac{16}{2}(6+96)=816$.

### Questions 2.2.2

1. $a=27$, $r=\frac{2}{3}$, $S_5 = a \frac{1 - r^5}{1-r} = 27 \frac{1 - (2/3)^5}{1 - 2/3} = \frac{211}{3}$,
2. The given expression represents the sum of a geometric progression (GP) with first term $a=729$ and common ratio $r=\frac{1}{3}$.
The sum over all integers n is given by $S_{\infty}=\frac{729}{1‚àí1/3}=\frac{2187}{2}$.
3. Let the first term of this GP be denoted by $a$ ($=8$), and the common ratio be denoted by $r$. 
We have the sum of the first 3 terms is $8(1+r+r^2)=38$. 
This equation is a quadratic with solutions $r=‚àí\frac{5}{2},\frac{3}{2}$.
4. The sum of the first $n$ terms in this GP is given by $S_n= 27 \frac{1‚àí(4/3)^n}{1‚àí4/3}$.
We require that $S_n>550$. The problem could be tackled by trial and error, but we will solve it analytically.
The problem rearranges to give $(\frac{4}{3})^n>\frac{631}{81}$ (take care with the direction of the inequality!).
By taking the natural logarithm we obtain $n > \frac{\ln \big( \frac{631}{81} \big)}{ \ln \big( \frac{4}{3} \big)}=7.136$ (4sf).
Since $n$ is an integer, the least number of terms required is $8$.

### Questions 2.3.1

1. $(x+9)^2 = \sum_{k=0}^9 \binom{n}{k} x^k y^{n-k} = \binom{9}{0} x^0 y^9 +  \binom{9}{1} x^1 y^8 +  \binom{9}{2} x^2 y^7 + 
\binom{9}{3} x^3 y^6 +  \binom{9}{4} x^4 y^5 +  \binom{9}{5} x^5 y^4 +  \binom{9}{6} x^6 y^3 + 
\binom{9}{7} x^7 y^2 +  \binom{9}{8} x^8 y^1 +  \binom{9}{9} x^9 y^0 $. 
$= x^0 y^9 +  9 x^1 y^8 +  36 x^2 y^7 + 84 x^3 y^6 + 126 x^4 y^5 + 126 x^5 y^4 + 84 x^6 y^3 + 36 x^7 y^2 +  9 x^8 y^1 +  x^9 y^0 $.
2. The term in $x^2 y^3$ is given by $\binom{5}{2} (2x)^2 (-3y)^3 =10 (2)^2 (-3)^3 x^2 y^3$.
The coefficient is $-1080$.
3. $(x^2 - \frac{1}{x})^9 = \sum_{k=0}^9 \binom{9}{k} x^{2k} (-x)^{k-9} = \sum_{k=0}^9 \binom{9}{k} x^{3k-9} (-1)^{k-9}$.
The constant terms is given by $k=3$ with coefficient $\binom{9}{3} (-1)^6 = 84$.
4. $(1+x-x^2)^7 = (1+(x-x^2))^7$
$ = \sum_{k=0}^7 \binom{7}{k} 1^{7-k} (x-x^2)^k$
$= \binom{7}{0}  + \binom{7}{1} (x - x^2) + \binom{7}{2} (x - x^2)^2 + \binom{7}{3} (x - x^2)^3 + 
\dots + \binom{7}{7} (x - x^2)^7$
$= 1  + 7 (x - x^2) + 21 (x - x^2)^2 + 35 (x - x^2)^3 + 
\dots + (x - x^2)^7$
$=1 + 7x - 7 x^2 + 21 (x^2 - 2 x^3 + x^4) + 35 (x^3 + \dots) + \dots$
$= 1 + 7 x + 14 x^2 - 7 x^3 - 49 x^4 - 14 x^5 + 77 x^6 + 29 x^7 - 77 x^8 - 14 x^9 + 49 x^{10} - 7 x^{11} - 14 x^{12} + 7 x^{13} - x^{14} $.

### Question 2.3.2

Starting by writing out the result for the right hand side of the first expression gives
$\binom{n}{k} + \binom{n}{k-1} = \frac{n!}{(n-k)!k!} + \frac{n!}{(n-k+1)!(k-1)!}$
$= \frac{n!(n-k+1)}{(n-k+1)!k!} + \frac{n! k }{(n-k+1)!(k)!} $
$= \frac{n!(n-k+1+k)}{(n-k+1)!k!} $
$= \frac{(n+1)!}{(n-k+1)!k!} $
$ = \binom{n+1}{k}$.

The second expression follows directly from the definition of $\binom{n}{k}$.

### Questions 2.4

1. $\lim_{x \to \infty}\frac{x+2}{x^2 - 2} = \lim_{x \to \infty} \frac{1/x + 2/x^2}{1-2/x^2}$
$= \frac{0+0}{1+0}$
$=0$.
2. $\lim_{x \to \infty}\frac{x-2}{x+2} = \lim_{x \to \infty} \frac{1 - 2/x}{1+2/x}$
$= \frac{1-0}{1+0}$
$=1$.
3. $\sqrt{x^2-2} - \sqrt{x^2+x}$
$ = \big(\sqrt{x^2-2} - \sqrt{x^2+x} \big) \frac{\sqrt{x^2-2} + \sqrt{x^2+x}}{\sqrt{x^2-2} + \sqrt{x^2+x}}$
$ = \frac{-x-2}{\sqrt{x^2-2} + \sqrt{x^2+x}}$
$ = \frac{-1-2/x}{\sqrt{1-2/x^2} + \sqrt{1+1/x} }$.
Thus, $\lim_{x \to \infty} \big(\sqrt{x^2-2} - \sqrt{x^2+x} \big)$ 
$= \frac{-1-0}{1+1}$
$ = -\frac{1}{2}$.

### Questions 2.5

1. $4 \sum_{r=1}^N r^3 = \sum_{r=1}^N \big( r^2(r+1)^2 - (r-1)^2 r^2 \big)$
$= \sum_{r=1}^N r^2(r+1)^2 - \sum{r=1}^N (r-1)^2 r^2  $
$= 1^2 2^2 + 2^2 3^2 + \dots + (N-1)^2 N^2 + N^2 (N+1)^2$
$ - \big( 0^2 1^2 + + 1^2 2^2 + 2^2 3^2 + \dots + (N-1)^2 N^2 \big)$.
Since all terms cancel except for $N^2 (N+1)^2$ we have that $\sum_{r=1}^N r^3 = \frac{N^2 (N+1)^2}{4}$.
2. Let $ \frac{2}{2(r+1)(r+2)}  = \frac{A}{r} + \frac{B}{r+1} + \frac{C}{r+2}$
$= \frac{A(r+1)(r+2) + B r (r+2) + Cr (r+1)}{ r (r+1) (r+2)}$.
By equating coefficients of $r^0$, $r^1$ and $r^2$ in the numerator, we obtain:
$A=1$, $B=-2$, $C=1$.
Then
$\sum_{r=1}^n \frac{2}{2(r+1)(r+2)}$
$=\sum_{r=1}^n \frac{1}{r} - 2 \sum_{r=1}^n \frac{1}{r+1} + \sum_{r=1}^n \frac{1}{r+2}$
$ = \sum_{r=1}^n \frac{1}{2} - 2 \frac{r=2}{n+1} \frac{1}{r} + \sum_{r=3}^{n+2} \frac{1}{r}$
$ = (1-2+1) \sum_{r=3}^n \frac{1}{r} + \big( \frac{1}{1} + \frac{1}{2} \big) 
-2 \big( \frac{1}{2} + \frac{1}{n+1} \big)
+\big( \frac{1}{n+1} + \frac{1}{n+1} \big)$
$=\frac{1}{n+2} - \frac{1}{n+1} + \frac{1}{2}$.

### Questions 2.6

1. Let $u_k = \frac{(2k)!}{2^k k!}$.
Then $\frac{u_{k+1}}{u_k}$
$= \frac{(2k+2)! (2^k k!)}{\big( 2^{k+1} (k+1)! \big) (2k)!}$
$ = \frac{(2k+2) (2k+1) (2k)! (2^k k!)}{\big( 2 2^{k} (k+1) k! \big) (2k)!}$
$ = \frac{(2k+2)(2k+1)}{2 (k+1)}$
$ = 2k+1$.
So, $\lim_{k \to \infty} \lvert \frac{u_{k+1}}{u_k} \rvert =  \lim_{k \to \infty} (2k+1) > 1$.
Thus we conclude that the series diverges.
2. Let $u_k \frac{(-1)^{k-1}}{k}$.
Then $ \big\lvert \frac{u_{k+1}}{u_k} \big\rvert =  \big\lvert \frac{(-1)^k}{(k+1) (-1)^{k-1} / k} \big\rvert$
$= \big\lvert \frac{k}{k+1} \big\rvert$
$ = \frac{1}{1+1/k}$.
So, $\lim_{k \to \infty} \big\lvert \frac{u_{k+1}}{u_k} \big\rvert$
$ =  \frac{1}{1+1/k} $
$ = 1$.
Thus we conclude that the test is inconclusive!
Further tests are required to determine convergence/divergence, which is beyond the scope of the course.

